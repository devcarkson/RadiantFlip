{% extends "dashnav.html" %}
{% load humanize %}
{% load static %}
{% block content %}
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQLOwXSOmOlAxGScDjAG+gAv5XnFmPDHpCPdWUygB9AaK3zIcM7iQ06zH" crossorigin="anonymous">

<style>
    .custom-btn {
        background-color: #f67942;
        border: none;
        font-weight:bold;
        transition: all 0.3s ease;
    }
    .custom-btn:hover{
        background-color:rgb(83 255 131);
        color:black;
        font-weight:bold;
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    /* Invest Page Animations */
    .invest-plan__item {
        opacity: 0;
        transform: translateY(50px);
        transition: all 0.8s ease;
    }

    .invest-plan__item.animate {
        opacity: 1;
        transform: translateY(0);
    }

    .invest-plan__item:nth-child(1) { animation-delay: 0.2s; }
    .invest-plan__item:nth-child(2) { animation-delay: 0.4s; }
    .invest-plan__item:nth-child(3) { animation-delay: 0.6s; }
    .invest-plan__item:nth-child(4) { animation-delay: 0.8s; }

    .invest-wrap {
        animation: slideInUp 1s ease-out;
    }

    @keyframes slideInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .calbox {
        animation: zoomIn 1.2s ease-out;
    }

    @keyframes zoomIn {
        from { transform: scale(0.9); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
    }

    .cal-res__item {
        transition: transform 0.3s ease;
    }

    .cal-res__item:hover {
        transform: scale(1.1);
    }

    .invest-tabs__item {
        transition: all 0.3s ease;
    }

    .invest-tabs__item:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }

</style>
<header class="uk-heading uk-text-center uk-margin-small-bottom">
    <h1 class="uk-heading-line">Stake Now </h1>
</header>
<section class="invest" style="margin-top:0;margin-left:1em">
    <div class="container">
        <div class="row" style="margin-left:1em">
            <div class="col-lg-6 order-2 order-lg-1">
                <div class="invest-plan">
                    <div class="invest-plan__list">
                        <div class="invest-plan__item">
                            <div class="plan-item__icon">
                                <img src="{% static "img-new/plan1.svg" %}" alt="" style="height:42px">
                            </div>
                            <div class="text-white mb-2" style="color:white">{{ plans.0.get_name_display }}</div>
                            <div class="invest-plan__head">
                                <div class="invest-plan__percent"> <span>{{ plans.0.daily_percentage }}<sub>%</sub></span>
                                    <p> daily for {{ plans.0.duration_hours }} hrs
                                    </p>
                                </div>
                            </div>
                            <div class="invest-plan__info">
                                <div class="invest-plan__info-item">
                                    <p>Principal Return<img src="{% static "img/calendar.svg" %}" alt="plan-info-1-1" />
                                    </p>
                                    <span>
                                        {{ plans.0.principal_return|yesno:"Yes,No" }}
                                    </span>
                                </div>
                                <div class="invest-plan__info-item">
                                    <p>min - max<img src="{% static "img/dollar.svg" %}" alt="plan-info-1-2" />
                                    </p>
                                    <span>${{ plans.0.min_amount |floatformat:2|intcomma }} - {{ plans.0.max_amount |floatformat:2|intcomma |default:"Unlimited" }}</span>
                                    <form method="POST" action="{% url 'stake' %}">
                                        {% csrf_token %}
                                        <div class="d-flex justify-content-center mt-2">
                                            <input type="hidden" name="plan_id" value="{{ plans.0.name }}"> <!-- LITE Plan ID -->
                                            <input type="text" name="amount" class="cal-input__input" size=7 placeholder="Amount">
                                            <button type="submit" class="btn custom-btn px-4 cal-input__input">Stake</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="invest-plan__item">
                            <div class="plan-item__icon">
                                <img src="{% static "img-new/plan2.svg" %}" alt="" style="height:42px">
                            </div>
                            <div class="text-white mb-2" style="color:white">{{ plans.1.get_name_display }}</div>
                            <div class="invest-plan__head">
                                <div class="invest-plan__percent"> <span>{{ plans.1.daily_percentage }}<sub>%</sub></span>
                                    <p> daily for {{ plans.1.duration_hours }} hrs
                                    </p>
                                </div>
                            </div>
                            <div class="invest-plan__info">
                                <div class="invest-plan__info-item">
                                    <p>Principal Return<img src="{% static "img/calendar.svg" %}" alt="plan-info-1-1" />
                                    </p>
                                    <span>
                                        {{ plans.1.principal_return|yesno:"Yes,No" }}
                                    </span>
                                </div>
                                <div class="invest-plan__info-item">
                                    <p>min - max<img src="{% static "img/dollar.svg" %}" alt="plan-info-1-2" />
                                    </p>
                                    <span>${{ plans.1.min_amount |floatformat:2|intcomma }} - {{ plans.1.max_amount |floatformat:2|intcomma |default:"Unlimited" }}</span>
                                    <form method="POST" action="{% url 'stake' %}">
                                        {% csrf_token %}
                                        <div class="d-flex justify-content-center mt-2">
                                            <input type="hidden" name="plan_id" value="{{ plans.1.name }}"> <!-- STANDARD Plan ID -->
                                            <input type="text" name="amount" class="cal-input__input" size=7 placeholder="Amount">
                                            <button type="submit" class="btn custom-btn px-4 cal-input__input">Stake</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="invest-plan mt-3">
                    <div class="invest-plan__list">
                        <div class="invest-plan__item">
                            <div class="plan-item__icon">
                                <img src="{% static "img-new/plan3.svg" %}" alt="" style="height:42px">
                            </div>
                            <div class="text-white mb-2" style="color:white">{{ plans.2.get_name_display }}</div>
                            <div class="invest-plan__head">
                                <div class="invest-plan__percent"> <span>{{ plans.2.daily_percentage }}<sub>%</sub></span>
                                    <p> daily for {{ plans.2.duration_hours }} hrs
                                    </p>
                                </div>
                            </div>
                            <div class="invest-plan__info">
                                <div class="invest-plan__info-item">
                                    <p>Principal Return<img src="{% static "img/calendar.svg" %}" alt="plan-info-1-1" />
                                    </p>
                                    <span>
                                        {{ plans.2.principal_return|yesno:"Yes,No" }}
                                    </span>
                                </div>
                                <div class="invest-plan__info-item">
                                    <p>min - max<img src="{% static "img/dollar.svg" %}" alt="plan-info-1-2" />
                                    </p>
                                    <span>${{ plans.2.min_amount |floatformat:2|intcomma }} - {{ plans.2.max_amount |floatformat:2|intcomma |default:"Unlimited" }}</span>
                                    <form method="POST" action="{% url 'stake' %}">
                                        {% csrf_token %}
                                        <div class="d-flex justify-content-center mt-2">
                                            <input type="hidden" name="plan_id" value="{{ plans.2.name }}"> <!-- PREMIUM Plan ID -->
                                            <input type="text" name="amount" class="cal-input__input" size=7 placeholder="Amount">
                                            <button type="submit" class="btn custom-btn px-4 cal-input__input">Stake</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="invest-plan__item">
                            <div class="plan-item__icon">
                                <img src="{% static "img-new/plan4.svg" %}" alt="" style="height:42px">
                            </div>
                            <div class="text-white mb-2" style="color:white">{{ plans.3.get_name_display }}</div>
                            <div class="invest-plan__head">

                                <div class="invest-plan__percent"> <span>{{ plans.3.daily_percentage }}<sub>%</sub></span>
                                    <p> daily for {{ plans.3.duration_hours }} hrs
                                    </p>
                                </div>
                            </div>
                            <div class="invest-plan__info">
                                <div class="invest-plan__info-item">
                                    <p>Principal Return<img src="{% static "img/calendar.svg" %}" alt="plan-info-1-1" />
                                    </p>
                                    <span>
                                        {{ plans.3.principal_return|yesno:"Yes,No" }}
                                    </span>
                                </div>
                                <div class="invest-plan__info-item">
                                    <p>min - max<img src="{% static "img/dollar.svg" %}" alt="plan-info-1-2" />
                                    </p>
                                    <span>${{ plans.3.min_amount |floatformat:2|intcomma }} - {{ plans.3.max_amount |floatformat:2|intcomma |default:"Unlimited" }}</span>
                                    <form method="POST" action="{% url 'stake' %}">
                                        {% csrf_token %}
                                        <div class="d-flex justify-content-center mt-2">
                                            <input type="hidden" name="plan_id" value="{{ plans.3.name }}"> <!-- DIAMOND Plan ID -->
                                            <input type="text" name="amount" class="cal-input__input" size=7 placeholder="Amount">
                                            <button type="submit" class="btn custom-btn px-4 cal-input__input">Stake</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!--///////////////////-->

            <div class="col-lg-6 order-1 order-lg-2">

                <div class="invest-wrap">
                    <div class="main-title">
                        <div class="main-title__text">Staking Program
                        </div>
                    </div>
                    <div class="main-text">
                        <p>Company offers various Staking options that do not require special
                            financial or trading skills from potential customers and provide the
                            high profitability.</p>
                        <p><b>Reliable business from an industry leader.</b></p>
                    </div>
                    <div class="invest-tabs__title">CALCULATE PROFIT
                    </div>
                    <div class="calbox p-4 my-4">
                        <div class="d-flex">
                            <div class="cal-icon d-flex align-items-center mr-3">
                                <img src="{% static "img/calicon.svg" %}" width="34" alt="">
                            </div>
                            <div class="cal-input mr-3">
                                <label class="d-block cal-label text-white">Select Plan</label>
                                <select name="plan" id="cal_plan" style="min-width:200px; color: #048e2a"
                                    class="cal-input__input">
                                    {% for plan in plans %}
                                    {% if plan %}
                                    <option value="{{ forloop.counter }}">{{ plan.daily_percentage }}% DAILY FOR {{ plan.duration_hours }} HRS</option>
                                    {% endif %}
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="cal-input">
                                <label class="d-block cal-label text-white">Enter Amount</label>
                                <input type="text" name="amount" class="cal-input__input" id="cal_amount"
                                    style="width:80px">
                            </div>
                        </div>

                    </div>


                    <div class="d-flex justify-content-center">
                        <div class="cal-res d-flex mt-3 mt-lg-0 mb-4">
                            <div class="cal-res__item">
                                <div class="cal-res__txt">DAILY Profit</div>
                                <div class="cal-res__val" id="daily_res">$0</div>
                            </div>
                            <div class="cal-res__item">
                                <div class="cal-res__txt">TOTAL Profit</div>
                                <div class="cal-res__val" id="total_res">$0</div>
                            </div>
                        </div>


                    </div>
                    <div class="invest-tabs" data-tabs-btns="invest">
                        <div class="invest-tabs__item">
                            <p>stable</p><span>profitability</span>
                            <img src="{% static "img/stable-profit.svg" %}" alt="">
                        </div>
                        <div class="invest-tabs__item">
                            <p>Fast</p><span>withdrawals</span>
                            <img src="{% static "img/instant-withdraw.svg" %}" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-RoSGddFrpIVzUoslnGgXG1LIUurOTFSpi9C3Ra/xVeyZjO2HX5vOymUdJq+kT2Gy" crossorigin="anonymous"></script>

<script>
    // Invest Page Animations
    document.addEventListener('DOMContentLoaded', function() {
        const investItems = document.querySelectorAll('.invest-plan__item');

        function animateOnScroll() {
            const scrollTop = window.pageYOffset;
            const windowHeight = window.innerHeight;

            investItems.forEach((item, index) => {
                const rect = item.getBoundingClientRect();
                if (rect.top < windowHeight - 100) {
                    setTimeout(() => {
                        item.classList.add('animate');
                    }, index * 200);
                }
            });
        }

        // Initial check
        animateOnScroll();

        // Listen for scroll events
        window.addEventListener('scroll', animateOnScroll);
    });
</script>

<script>
    $(document).ready(function () {
        // Define the daily profit percentages for each plan
        var dailyRates = {{ daily_rates|safe }};

        // Define the duration of each plan (in hours)
        var planDurations = {{ plan_durations|safe }};

        // Listen for changes in the plan or amount fields
        $('#cal_plan, #cal_amount').on('change keyup', function () {
            calculateProfits();
        });

        function calculateProfits() {
            // Get the selected plan and amount
            var plan = $('#cal_plan').val();
            var amount = parseFloat($('#cal_amount').val());

            // Validate the amount
            if (isNaN(amount) || amount < 0) {
                $('#daily_res').text('$0');
                $('#total_res').text('$0');
                return;
            }

            // Calculate the daily profit based on the percentage increase
            var dailyProfit = amount * (dailyRates[plan] / 100);
            var totalDays = planDurations[plan] / 24;  // Convert hours to days
            var totalProfit = dailyProfit * totalDays;

            // Update the result fields with the calculated profits
            $('#daily_res').text('$' + dailyProfit.toFixed(2)); // Show daily profit with 2 decimal places
            $('#total_res').text('$' + totalProfit.toFixed(2)); // Show total profit with 2 decimal places
        }
    });
</script>

{% endblock content %}